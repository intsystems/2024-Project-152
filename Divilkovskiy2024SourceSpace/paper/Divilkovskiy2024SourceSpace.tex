\documentclass{article}
\usepackage{arxiv}

\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{booktabs}
\usepackage{amsfonts}
\usepackage{nicefrac}
\usepackage{microtype}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{doi}

\pagestyle{fancy}



\title{Восстановление прогноза, сделанного в метрическом вероятностном пространстве, в исходное пространство (временных рядов)}

\author{ Maxim Divilkovskiy \\
% \thanks{Use footnote for providing further
% 		information about author (webpage, alternative
% 		address)---\emph{not} for acknowledging funding agencies.} \\
	Chair of Data Analysis\\
	MIPT\\
	divilkovskii.mm@phystech.edu \\
	%% examples of more authors
	\And
	Vadim Strijov \\
	FRC CSC of the RAS\\
	Moscow, Russia\\
        strijov@phystech.edu \\
	% Santa Narimana, Levand \\
	% \texttt{stariate@ee.mount-sheikh.edu} \\
	%% \AND
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
	%% \And
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
	%% \And
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
}
\date{}

\renewcommand{\shorttitle}{\textit{arXiv} Template}

%%% Add PDF metadata to help others organize their library
%%% Once the PDF is generated, you can check the metadata with
%%% $ pdfinfo template.pdf
\hypersetup{
pdfauthor={Maxim Divilkovskiy},
}

\graphicspath{ {./figures/} }

\begin{document}
\maketitle

\begin{abstract}
	Исследование посвящено проблеме прогнозирования временных рядов с высокой ковариацией. Задача решается для наборов временных рядов с высокой дисперсией, проявляющейся, например, в сигналах головного мозга или ценах финансовых активов. Для решения данной задачи предлагается построение пространства парных расстояний, представляющего метрическую конфигурацию временных рядов. Прогноз осуществляется в этом пространстве, а затем результат возвращается в исходное пространство.
	В данной статье рассматриваются методы перевода прогноза из метрического пространства в исходное пространство временных рядов. Помимо этого, приводится оценка качества прогноза. Новизна работы заключается в использовании риманова пространства в качестве метрического, а также в использовании римановых моделей.


\end{abstract}


\keywords{Riemannian Space \and Trades \and Multidimensional Scaling \and Time Series}

\section{Introduction TO BE REWRITTEN}
	Временные ряды возникают во многих прикладных задачах, таких как анализ физической активности, мозговых волн или биржевых котировок. Цель данной работы заключается в представлении нового метода прогнозирования для конкретного типа временных рядов, характеризующихся высокой дисперсией и высокой попарной ковариацией. Задача разбивается на три этапа: сначала исходное пространство временных рядов трансформируется в метрическое пространство (по попарным расстояниям), затем в этом пространстве производится прогноз, после чего результат возвращается в исходное пространство. В данной статье исследуется восстановление ответа в пространство временных рядов, то есть третий этап задачи. Также проводится оценка качества прогноза.
		
	Классические способы предсказания временных рядов, такие как LSTM \cite{LSTM}, SSA \cite{SSA} и многие другие \cite{Biosignals}, \cite{boyd2017multiperiod} основаны на предсказании значения одного ряда, тогда как в данной работе предлагается анализировать изменение набора временных рядов. Подобное исследование проводится в статье \cite{MulticorrelatedQuadratic}, однако в ней делается упор на задаче feature selection.
	
	Новизна работы заключается в том, что прогнозирование делается не в исходном пространстве, а в пространстве попарных расстояний. Преимущество данного метода заключается в том, что на реальных наборах временных рядов часто наблюдается зависимость, близкая к линейной, и эта дополнительная информация может улучшить качество итогового прогноза.
	
	Метрическое пространство выбирается таким образом, чтобы из него можно было получить ответ. Помимо попарных скалярных произведений, можно использовать функции, являющиеся \textit{ядрами}, то есть удовлетворяющие условиям Мёрсера.
	
	Эксперимент проводится на биологических и финансовых данных. Цель эксперимента заключается в выборе наилучшего способа построения метрического пространства.

\section{Problem Statement TO BE REWRITTEN}

\subsection{Formal Problem}

Предполагается, что набор временных из $d$ рядов задан $t$ векторами:

$$[\vec{x}_1, \vec{x}_2, \ldots, \vec{x}_t], \forall k: \vec{x}_k \in \mathbb{R}^d $$

$\vec{x}_{t_i, k}$ задаёт собой значение ряда с индексом $k$ в момент времени $t_i$.

Задача заключается в прогнозе $\vec{x}_{t+1}$.

\subsection{Base Algorithm}

1. Построить матрицу расстояний.

\begin{equation}
	\hat{\Sigma}_T = \frac{1}{T} \sum_{t=1}^{T} (x_t - \mu_T)(x_t - \mu_T)^T
\end{equation}

\begin{equation}
	\mu_T = \frac{1}{T} \sum_{t=1}^{T} x_t
\end{equation}

2. Спрогнозировать матрицу расстояний на следующем моменте времени $\hat{\Sigma}_{T+1}^s \approx \hat{\Sigma}_{T+1} | \hat{\Sigma}_{T}$. Линейная регрессия:

\begin{equation}
	\hat{\Sigma}_{T+1}^s = W \cdot \hat{\Sigma}_{T}
\end{equation}


3. Найти такой оптимальный $x_{T+1}$, что ошибка прогнозирования временных рядов минимальна.

\section{Computational Experiment}

Исследуются следующие алгоритмы прогнозирования:

\begin{itemize}
	\item LSTM \cite{LSTM}
	\item SARIMA \cite{ARIMAvsLSTM}
	\item MSSA \cite{SSA}
\end{itemize}

\subsection{LSTM}

LSTM, в отличии от обыкновенной RNN позволяет выделять как кратковременные, так и долговременные зависимости, что позволяет с довольно высокой точностью прогнозировать временные ряды.

В качестве теста используется зашумленный временной ряд длины T, состоящий из суммы синусов и косинусов разных амплитуд и сдвигов. Из этого временного ряда генерируется выборка следующим алгоритмом:\\
1. Выбирается размер окна $W$.\\
2. Ряд разбивается на $T-W-1$ окон размера $W+1$ со сдвигом 1. Эти окна будут семплами\\
3. В каждом из полученных окон первые $W$ будут аргументами на данном семпле, а последнее~--- результатом.

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{LSTM-prediction.png}
	\caption{Прогноз с использованием LSTM}
	\label{fig:fig1}
\end{figure}

Ряд восстанавливается неплохо, однако минусом является то, что при усложнении данных сильно растёт сложность модели. Так же, LSTM не может работать с многомерными рядами.

\subsection{SARIMA}

ARIMA позволяет находить авторегрессионные зависимости. SARIMA (Seasonal ARIMA) учитывает так же сезонность данных. Это может быть полезным в случае с данными природного характера, как например, температура воздуха или выработка электричества.

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{SARIMA-prediction.png}
	\caption{Прогноз с использованием SARIMA}
	\label{fig:fig2}
\end{figure}

Ряд прогнозируется довольно плохо, в случае если он имеет достаточно нетривиальную структуру. Так же, в данных может не быть явной сезонности, что ухудшает точность данного метода.

\subsection{MSSA}

MSSA (Multivariate Singular Spectrum Analysis) в отличие от других методов позволяет брать во внимание корреляцию между несколькими рядами и прогнозировать несколько.

\section{Метрика}

При условии высокой попарной корреляции входных рядов и постановке задачи о предсказании значения рядов в следующий момент времени необходимо определить достаточные данные для модели.

\paragraph{Недостаточность матрицы попарных расстояний}

Пусть дана предсказанная матрица попарных расстояний $\Sigma$ размера $d \times d$ для многомерного временного ряда $\overline{X} \in \mathbb{R}^{d \times t}$. Предсказывается $y \in \mathbb{R}^d$. Так же, известна метрика $d : \mathbb{R}^{t+1} \times \mathbb{R}^{t+1} \rightarrow \mathbb{R}$, введённая на временных рядах, обладающая свойствами метрики. То есть, $\Sigma_{i,j} = d(X_i \circ y_i, X_j \circ y_j)$, где $\circ$ означает конкатенацию векторов.

В качестве примера рассмотрим евклидову метрику: 

$$d(p,q)=\sqrt{\sum_{k=1}^n (p_k-q_k)^2}.$$

Использование данной метрики приводит к тому, что прибавление ко всем координатам $y$ некоторой константы $C$ не изменяет ответ. В случае задачи предсказывания временных рядов это свойство критично, поскольку даже в случае верного предсказания матрицы $\Sigma$ невозможно понять как себя поведут временные ряды в момент времени $t+1$.

Это приводит к невозможности использования алгоритма MDS для восстановления ответа в исходное пространство временных рядов.

Однако, даже использование других метрик не позволяет избавиться от проблемы. Рассмотрим метрику $d(x, y)$ как функцию из $\mathbb{R}^{2t+2}$ в $\mathbb{R}$. Известно, что метрика не сюръективна, поскольку $d(x, x) = 0$. Из этого следует существование нескольких возможных ответов на задачу. \textbf{TODO: возможно стоит использовать теорему Рисса об эквивалентности норм в конечномерных пространствах.}

Исходя из этих утверждений, использование только лишь матрицы расстояний не позволяет решить задачу прогнозирования.

\section{

\bibliography{references}
\bibliographystyle{plain}


\end{document}